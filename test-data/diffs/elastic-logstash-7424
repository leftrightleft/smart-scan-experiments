diff --git a/logstash-core/build.gradle b/logstash-core/build.gradle
index 5d4cf1da62c..9048fd99713 100644
--- a/logstash-core/build.gradle
+++ b/logstash-core/build.gradle
@@ -53,15 +53,16 @@ task cleanGemjar {
 
 clean.dependsOn(cleanGemjar)
 jar.finalizedBy(copyGemjar)
-
-task gemspec_jars << {
-    File gemspec_jars = file("./gemspec_jars.rb")
-    gemspec_jars.newWriter().withWriter { w ->
-        w << "# This file is generated by Gradle as part of the build process. It extracts the build.gradle\n"
-        w << "# runtime dependencies to generate this gemspec dependencies file to be eval'ed by the gemspec\n"
-        w << "# for the jar-dependencies requirements.\n\n"
-        configurations.runtime.allDependencies.each { dependency ->
-            w << "gem.requirements << \"jar ${dependency.group}:${dependency.name}, ${dependency.version}\"\n"
+task gemspec_jars {
+    doLast {
+        File gemspec_jars = file("./gemspec_jars.rb")
+        gemspec_jars.newWriter().withWriter { w ->
+            w << "# This file is generated by Gradle as part of the build process. It extracts the build.gradle\n"
+                w << "# runtime dependencies to generate this gemspec dependencies file to be eval'ed by the gemspec\n"
+                w << "# for the jar-dependencies requirements.\n\n"
+                configurations.runtime.allDependencies.each { dependency ->
+                    w << "gem.requirements << \"jar ${dependency.group}:${dependency.name}, ${dependency.version}\"\n"
+                }
         }
     }
 }
