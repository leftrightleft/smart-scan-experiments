diff --git a/logstash-core-event-java/lib/logstash-core-event-java.rb b/lib/logstash-core-event-java.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash-core-event-java.rb
rename to lib/logstash-core-event-java.rb
diff --git a/logstash-core-event-java/lib/logstash-core-event-java/logstash-core-event-java.rb b/lib/logstash-core-event-java/logstash-core-event-java.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash-core-event-java/logstash-core-event-java.rb
rename to lib/logstash-core-event-java/logstash-core-event-java.rb
diff --git a/logstash-core-event-java/lib/logstash-core-event-java/version.rb b/lib/logstash-core-event-java/version.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash-core-event-java/version.rb
rename to lib/logstash-core-event-java/version.rb
diff --git a/logstash-core-event-java/lib/logstash-core-event-java_jars.rb b/lib/logstash-core-event-java_jars.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash-core-event-java_jars.rb
rename to lib/logstash-core-event-java_jars.rb
diff --git a/logstash-core-event-java/lib/logstash-core-event.rb b/lib/logstash-core-event.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash-core-event.rb
rename to lib/logstash-core-event.rb
diff --git a/logstash-core-event/lib/logstash-core-event/logstash-core-event.rb b/lib/logstash-core-event/logstash-core-event.rb
similarity index 100%
rename from logstash-core-event/lib/logstash-core-event/logstash-core-event.rb
rename to lib/logstash-core-event/logstash-core-event.rb
diff --git a/logstash-core-event/lib/logstash-core-event/version.rb b/lib/logstash-core-event/version.rb
similarity index 100%
rename from logstash-core-event/lib/logstash-core-event/version.rb
rename to lib/logstash-core-event/version.rb
diff --git a/logstash-core-plugin-api/lib/logstash-core-plugin-api/version.rb b/lib/logstash-core-plugin-api/version.rb
similarity index 100%
rename from logstash-core-plugin-api/lib/logstash-core-plugin-api/version.rb
rename to lib/logstash-core-plugin-api/version.rb
diff --git a/logstash-core-queue-jruby/lib/logstash-core-queue-jruby/logstash-core-queue-jruby.rb b/lib/logstash-core-queue-jruby/logstash-core-queue-jruby.rb
similarity index 100%
rename from logstash-core-queue-jruby/lib/logstash-core-queue-jruby/logstash-core-queue-jruby.rb
rename to lib/logstash-core-queue-jruby/logstash-core-queue-jruby.rb
diff --git a/logstash-core-queue-jruby/lib/logstash-core-queue-jruby/version.rb b/lib/logstash-core-queue-jruby/version.rb
similarity index 100%
rename from logstash-core-queue-jruby/lib/logstash-core-queue-jruby/version.rb
rename to lib/logstash-core-queue-jruby/version.rb
diff --git a/logstash-core/lib/logstash-core.rb b/lib/logstash-core.rb
similarity index 100%
rename from logstash-core/lib/logstash-core.rb
rename to lib/logstash-core.rb
diff --git a/logstash-core/lib/logstash-core/logstash-core.rb b/lib/logstash-core/logstash-core.rb
similarity index 100%
rename from logstash-core/lib/logstash-core/logstash-core.rb
rename to lib/logstash-core/logstash-core.rb
diff --git a/logstash-core/lib/logstash-core/version.rb b/lib/logstash-core/version.rb
similarity index 100%
rename from logstash-core/lib/logstash-core/version.rb
rename to lib/logstash-core/version.rb
diff --git a/logstash-core/lib/logstash-core_jars.rb b/lib/logstash-core_jars.rb
similarity index 100%
rename from logstash-core/lib/logstash-core_jars.rb
rename to lib/logstash-core_jars.rb
diff --git a/logstash-core/lib/logstash/agent.rb b/lib/logstash/agent.rb
similarity index 100%
rename from logstash-core/lib/logstash/agent.rb
rename to lib/logstash/agent.rb
diff --git a/logstash-core/lib/logstash/api/app_helpers.rb b/lib/logstash/api/app_helpers.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/app_helpers.rb
rename to lib/logstash/api/app_helpers.rb
diff --git a/logstash-core/lib/logstash/api/command_factory.rb b/lib/logstash/api/command_factory.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/command_factory.rb
rename to lib/logstash/api/command_factory.rb
diff --git a/logstash-core/lib/logstash/api/commands/base.rb b/lib/logstash/api/commands/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/base.rb
rename to lib/logstash/api/commands/base.rb
diff --git a/logstash-core/lib/logstash/api/commands/default_metadata.rb b/lib/logstash/api/commands/default_metadata.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/default_metadata.rb
rename to lib/logstash/api/commands/default_metadata.rb
diff --git a/logstash-core/lib/logstash/api/commands/hot_threads_reporter.rb b/lib/logstash/api/commands/hot_threads_reporter.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/hot_threads_reporter.rb
rename to lib/logstash/api/commands/hot_threads_reporter.rb
diff --git a/logstash-core/lib/logstash/api/commands/node.rb b/lib/logstash/api/commands/node.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/node.rb
rename to lib/logstash/api/commands/node.rb
diff --git a/logstash-core/lib/logstash/api/commands/stats.rb b/lib/logstash/api/commands/stats.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/stats.rb
rename to lib/logstash/api/commands/stats.rb
diff --git a/logstash-core/lib/logstash/api/commands/system/basicinfo_command.rb b/lib/logstash/api/commands/system/basicinfo_command.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/system/basicinfo_command.rb
rename to lib/logstash/api/commands/system/basicinfo_command.rb
diff --git a/logstash-core/lib/logstash/api/commands/system/plugins_command.rb b/lib/logstash/api/commands/system/plugins_command.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/commands/system/plugins_command.rb
rename to lib/logstash/api/commands/system/plugins_command.rb
diff --git a/logstash-core/lib/logstash/api/errors.rb b/lib/logstash/api/errors.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/errors.rb
rename to lib/logstash/api/errors.rb
diff --git a/logstash-core/lib/logstash/api/modules/base.rb b/lib/logstash/api/modules/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/base.rb
rename to lib/logstash/api/modules/base.rb
diff --git a/logstash-core/lib/logstash/api/modules/logging.rb b/lib/logstash/api/modules/logging.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/logging.rb
rename to lib/logstash/api/modules/logging.rb
diff --git a/logstash-core/lib/logstash/api/modules/node.rb b/lib/logstash/api/modules/node.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/node.rb
rename to lib/logstash/api/modules/node.rb
diff --git a/logstash-core/lib/logstash/api/modules/node_stats.rb b/lib/logstash/api/modules/node_stats.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/node_stats.rb
rename to lib/logstash/api/modules/node_stats.rb
diff --git a/logstash-core/lib/logstash/api/modules/plugins.rb b/lib/logstash/api/modules/plugins.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/plugins.rb
rename to lib/logstash/api/modules/plugins.rb
diff --git a/logstash-core/lib/logstash/api/modules/root.rb b/lib/logstash/api/modules/root.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/root.rb
rename to lib/logstash/api/modules/root.rb
diff --git a/logstash-core/lib/logstash/api/modules/stats.rb b/lib/logstash/api/modules/stats.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/modules/stats.rb
rename to lib/logstash/api/modules/stats.rb
diff --git a/logstash-core/lib/logstash/api/rack_app.rb b/lib/logstash/api/rack_app.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/rack_app.rb
rename to lib/logstash/api/rack_app.rb
diff --git a/logstash-core/lib/logstash/api/service.rb b/lib/logstash/api/service.rb
similarity index 100%
rename from logstash-core/lib/logstash/api/service.rb
rename to lib/logstash/api/service.rb
diff --git a/logstash-core/lib/logstash/build.rb b/lib/logstash/build.rb
similarity index 100%
rename from logstash-core/lib/logstash/build.rb
rename to lib/logstash/build.rb
diff --git a/logstash-core/lib/logstash/certs/cacert.pem b/lib/logstash/certs/cacert.pem
similarity index 100%
rename from logstash-core/lib/logstash/certs/cacert.pem
rename to lib/logstash/certs/cacert.pem
diff --git a/logstash-core/lib/logstash/codecs/base.rb b/lib/logstash/codecs/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/codecs/base.rb
rename to lib/logstash/codecs/base.rb
diff --git a/logstash-core/lib/logstash/config/config_ast.rb b/lib/logstash/config/config_ast.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/config_ast.rb
rename to lib/logstash/config/config_ast.rb
diff --git a/logstash-core/lib/logstash/config/cpu_core_strategy.rb b/lib/logstash/config/cpu_core_strategy.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/cpu_core_strategy.rb
rename to lib/logstash/config/cpu_core_strategy.rb
diff --git a/logstash-core/lib/logstash/config/defaults.rb b/lib/logstash/config/defaults.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/defaults.rb
rename to lib/logstash/config/defaults.rb
diff --git a/logstash-core/lib/logstash/config/file.rb b/lib/logstash/config/file.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/file.rb
rename to lib/logstash/config/file.rb
diff --git a/logstash-core/lib/logstash/config/grammar.rb b/lib/logstash/config/grammar.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/grammar.rb
rename to lib/logstash/config/grammar.rb
diff --git a/logstash-core/lib/logstash/config/grammar.treetop b/lib/logstash/config/grammar.treetop
similarity index 100%
rename from logstash-core/lib/logstash/config/grammar.treetop
rename to lib/logstash/config/grammar.treetop
diff --git a/logstash-core/lib/logstash/config/loader.rb b/lib/logstash/config/loader.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/loader.rb
rename to lib/logstash/config/loader.rb
diff --git a/logstash-core/lib/logstash/config/mixin.rb b/lib/logstash/config/mixin.rb
similarity index 100%
rename from logstash-core/lib/logstash/config/mixin.rb
rename to lib/logstash/config/mixin.rb
diff --git a/logstash-core/lib/logstash/environment.rb b/lib/logstash/environment.rb
similarity index 100%
rename from logstash-core/lib/logstash/environment.rb
rename to lib/logstash/environment.rb
diff --git a/logstash-core/lib/logstash/errors.rb b/lib/logstash/errors.rb
similarity index 100%
rename from logstash-core/lib/logstash/errors.rb
rename to lib/logstash/errors.rb
diff --git a/logstash-core-event-java/lib/logstash/event.rb b/lib/logstash/event.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash/event.rb
rename to lib/logstash/event.rb
diff --git a/logstash-core/lib/logstash/event_dispatcher.rb b/lib/logstash/event_dispatcher.rb
similarity index 100%
rename from logstash-core/lib/logstash/event_dispatcher.rb
rename to lib/logstash/event_dispatcher.rb
diff --git a/logstash-core/lib/logstash/filter_delegator.rb b/lib/logstash/filter_delegator.rb
similarity index 100%
rename from logstash-core/lib/logstash/filter_delegator.rb
rename to lib/logstash/filter_delegator.rb
diff --git a/logstash-core/lib/logstash/filters/base.rb b/lib/logstash/filters/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/filters/base.rb
rename to lib/logstash/filters/base.rb
diff --git a/logstash-core/lib/logstash/inputs/base.rb b/lib/logstash/inputs/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/inputs/base.rb
rename to lib/logstash/inputs/base.rb
diff --git a/logstash-core/lib/logstash/inputs/threadable.rb b/lib/logstash/inputs/threadable.rb
similarity index 100%
rename from logstash-core/lib/logstash/inputs/threadable.rb
rename to lib/logstash/inputs/threadable.rb
diff --git a/logstash-core/lib/logstash/instrument/collector.rb b/lib/logstash/instrument/collector.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/collector.rb
rename to lib/logstash/instrument/collector.rb
diff --git a/logstash-core/lib/logstash/instrument/metric.rb b/lib/logstash/instrument/metric.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric.rb
rename to lib/logstash/instrument/metric.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_store.rb b/lib/logstash/instrument/metric_store.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_store.rb
rename to lib/logstash/instrument/metric_store.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_type.rb b/lib/logstash/instrument/metric_type.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_type.rb
rename to lib/logstash/instrument/metric_type.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_type/base.rb b/lib/logstash/instrument/metric_type/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_type/base.rb
rename to lib/logstash/instrument/metric_type/base.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_type/counter.rb b/lib/logstash/instrument/metric_type/counter.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_type/counter.rb
rename to lib/logstash/instrument/metric_type/counter.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_type/gauge.rb b/lib/logstash/instrument/metric_type/gauge.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_type/gauge.rb
rename to lib/logstash/instrument/metric_type/gauge.rb
diff --git a/logstash-core/lib/logstash/instrument/metric_type/mean.rb b/lib/logstash/instrument/metric_type/mean.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/metric_type/mean.rb
rename to lib/logstash/instrument/metric_type/mean.rb
diff --git a/logstash-core/lib/logstash/instrument/namespaced_metric.rb b/lib/logstash/instrument/namespaced_metric.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/namespaced_metric.rb
rename to lib/logstash/instrument/namespaced_metric.rb
diff --git a/logstash-core/lib/logstash/instrument/namespaced_null_metric.rb b/lib/logstash/instrument/namespaced_null_metric.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/namespaced_null_metric.rb
rename to lib/logstash/instrument/namespaced_null_metric.rb
diff --git a/logstash-core/lib/logstash/instrument/null_metric.rb b/lib/logstash/instrument/null_metric.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/null_metric.rb
rename to lib/logstash/instrument/null_metric.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/base.rb b/lib/logstash/instrument/periodic_poller/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/base.rb
rename to lib/logstash/instrument/periodic_poller/base.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/cgroup.rb b/lib/logstash/instrument/periodic_poller/cgroup.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/cgroup.rb
rename to lib/logstash/instrument/periodic_poller/cgroup.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/jvm.rb b/lib/logstash/instrument/periodic_poller/jvm.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/jvm.rb
rename to lib/logstash/instrument/periodic_poller/jvm.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/load_average.rb b/lib/logstash/instrument/periodic_poller/load_average.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/load_average.rb
rename to lib/logstash/instrument/periodic_poller/load_average.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/os.rb b/lib/logstash/instrument/periodic_poller/os.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/os.rb
rename to lib/logstash/instrument/periodic_poller/os.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_poller/pq.rb b/lib/logstash/instrument/periodic_poller/pq.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_poller/pq.rb
rename to lib/logstash/instrument/periodic_poller/pq.rb
diff --git a/logstash-core/lib/logstash/instrument/periodic_pollers.rb b/lib/logstash/instrument/periodic_pollers.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/periodic_pollers.rb
rename to lib/logstash/instrument/periodic_pollers.rb
diff --git a/logstash-core/lib/logstash/instrument/snapshot.rb b/lib/logstash/instrument/snapshot.rb
similarity index 100%
rename from logstash-core/lib/logstash/instrument/snapshot.rb
rename to lib/logstash/instrument/snapshot.rb
diff --git a/logstash-core/lib/logstash/java_integration.rb b/lib/logstash/java_integration.rb
similarity index 100%
rename from logstash-core/lib/logstash/java_integration.rb
rename to lib/logstash/java_integration.rb
diff --git a/logstash-core/lib/logstash/json.rb b/lib/logstash/json.rb
similarity index 100%
rename from logstash-core/lib/logstash/json.rb
rename to lib/logstash/json.rb
diff --git a/logstash-core/lib/logstash/logging.rb b/lib/logstash/logging.rb
similarity index 100%
rename from logstash-core/lib/logstash/logging.rb
rename to lib/logstash/logging.rb
diff --git a/logstash-core/lib/logstash/logging/json.rb b/lib/logstash/logging/json.rb
similarity index 100%
rename from logstash-core/lib/logstash/logging/json.rb
rename to lib/logstash/logging/json.rb
diff --git a/logstash-core/lib/logstash/logging/logger.rb b/lib/logstash/logging/logger.rb
similarity index 100%
rename from logstash-core/lib/logstash/logging/logger.rb
rename to lib/logstash/logging/logger.rb
diff --git a/logstash-core/lib/logstash/namespace.rb b/lib/logstash/namespace.rb
similarity index 100%
rename from logstash-core/lib/logstash/namespace.rb
rename to lib/logstash/namespace.rb
diff --git a/logstash-core/lib/logstash/output_delegator.rb b/lib/logstash/output_delegator.rb
similarity index 100%
rename from logstash-core/lib/logstash/output_delegator.rb
rename to lib/logstash/output_delegator.rb
diff --git a/logstash-core/lib/logstash/output_delegator_strategies/legacy.rb b/lib/logstash/output_delegator_strategies/legacy.rb
similarity index 100%
rename from logstash-core/lib/logstash/output_delegator_strategies/legacy.rb
rename to lib/logstash/output_delegator_strategies/legacy.rb
diff --git a/logstash-core/lib/logstash/output_delegator_strategies/shared.rb b/lib/logstash/output_delegator_strategies/shared.rb
similarity index 100%
rename from logstash-core/lib/logstash/output_delegator_strategies/shared.rb
rename to lib/logstash/output_delegator_strategies/shared.rb
diff --git a/logstash-core/lib/logstash/output_delegator_strategies/single.rb b/lib/logstash/output_delegator_strategies/single.rb
similarity index 100%
rename from logstash-core/lib/logstash/output_delegator_strategies/single.rb
rename to lib/logstash/output_delegator_strategies/single.rb
diff --git a/logstash-core/lib/logstash/output_delegator_strategy_registry.rb b/lib/logstash/output_delegator_strategy_registry.rb
similarity index 100%
rename from logstash-core/lib/logstash/output_delegator_strategy_registry.rb
rename to lib/logstash/output_delegator_strategy_registry.rb
diff --git a/logstash-core/lib/logstash/outputs/base.rb b/lib/logstash/outputs/base.rb
similarity index 100%
rename from logstash-core/lib/logstash/outputs/base.rb
rename to lib/logstash/outputs/base.rb
diff --git a/logstash-core/lib/logstash/patches.rb b/lib/logstash/patches.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches.rb
rename to lib/logstash/patches.rb
diff --git a/logstash-core/lib/logstash/patches/bugfix_jruby_2558.rb b/lib/logstash/patches/bugfix_jruby_2558.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/bugfix_jruby_2558.rb
rename to lib/logstash/patches/bugfix_jruby_2558.rb
diff --git a/logstash-core/lib/logstash/patches/cabin.rb b/lib/logstash/patches/cabin.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/cabin.rb
rename to lib/logstash/patches/cabin.rb
diff --git a/logstash-core/lib/logstash/patches/clamp.rb b/lib/logstash/patches/clamp.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/clamp.rb
rename to lib/logstash/patches/clamp.rb
diff --git a/logstash-core/lib/logstash/patches/exception_to_json.rb b/lib/logstash/patches/exception_to_json.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/exception_to_json.rb
rename to lib/logstash/patches/exception_to_json.rb
diff --git a/logstash-core/lib/logstash/patches/profile_require_calls.rb b/lib/logstash/patches/profile_require_calls.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/profile_require_calls.rb
rename to lib/logstash/patches/profile_require_calls.rb
diff --git a/logstash-core/lib/logstash/patches/puma.rb b/lib/logstash/patches/puma.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/puma.rb
rename to lib/logstash/patches/puma.rb
diff --git a/logstash-core/lib/logstash/patches/rubygems.rb b/lib/logstash/patches/rubygems.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/rubygems.rb
rename to lib/logstash/patches/rubygems.rb
diff --git a/logstash-core/lib/logstash/patches/stronger_openssl_defaults.rb b/lib/logstash/patches/stronger_openssl_defaults.rb
similarity index 100%
rename from logstash-core/lib/logstash/patches/stronger_openssl_defaults.rb
rename to lib/logstash/patches/stronger_openssl_defaults.rb
diff --git a/logstash-core/lib/logstash/pipeline.rb b/lib/logstash/pipeline.rb
similarity index 100%
rename from logstash-core/lib/logstash/pipeline.rb
rename to lib/logstash/pipeline.rb
diff --git a/logstash-core/lib/logstash/pipeline_reporter.rb b/lib/logstash/pipeline_reporter.rb
similarity index 100%
rename from logstash-core/lib/logstash/pipeline_reporter.rb
rename to lib/logstash/pipeline_reporter.rb
diff --git a/logstash-core/lib/logstash/plugin.rb b/lib/logstash/plugin.rb
similarity index 100%
rename from logstash-core/lib/logstash/plugin.rb
rename to lib/logstash/plugin.rb
diff --git a/logstash-core/lib/logstash/plugins/hooks_registry.rb b/lib/logstash/plugins/hooks_registry.rb
similarity index 100%
rename from logstash-core/lib/logstash/plugins/hooks_registry.rb
rename to lib/logstash/plugins/hooks_registry.rb
diff --git a/logstash-core/lib/logstash/plugins/registry.rb b/lib/logstash/plugins/registry.rb
similarity index 100%
rename from logstash-core/lib/logstash/plugins/registry.rb
rename to lib/logstash/plugins/registry.rb
diff --git a/logstash-core/lib/logstash/program.rb b/lib/logstash/program.rb
similarity index 100%
rename from logstash-core/lib/logstash/program.rb
rename to lib/logstash/program.rb
diff --git a/logstash-core/lib/logstash/runner.rb b/lib/logstash/runner.rb
similarity index 100%
rename from logstash-core/lib/logstash/runner.rb
rename to lib/logstash/runner.rb
diff --git a/logstash-core/lib/logstash/settings.rb b/lib/logstash/settings.rb
similarity index 100%
rename from logstash-core/lib/logstash/settings.rb
rename to lib/logstash/settings.rb
diff --git a/logstash-core/lib/logstash/shutdown_watcher.rb b/lib/logstash/shutdown_watcher.rb
similarity index 100%
rename from logstash-core/lib/logstash/shutdown_watcher.rb
rename to lib/logstash/shutdown_watcher.rb
diff --git a/logstash-core-event-java/lib/logstash/string_interpolation.rb b/lib/logstash/string_interpolation.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash/string_interpolation.rb
rename to lib/logstash/string_interpolation.rb
diff --git a/logstash-core-event-java/lib/logstash/timestamp.rb b/lib/logstash/timestamp.rb
similarity index 100%
rename from logstash-core-event-java/lib/logstash/timestamp.rb
rename to lib/logstash/timestamp.rb
diff --git a/logstash-core/lib/logstash/universal_plugin.rb b/lib/logstash/universal_plugin.rb
similarity index 100%
rename from logstash-core/lib/logstash/universal_plugin.rb
rename to lib/logstash/universal_plugin.rb
diff --git a/logstash-core/lib/logstash/util.rb b/lib/logstash/util.rb
similarity index 100%
rename from logstash-core/lib/logstash/util.rb
rename to lib/logstash/util.rb
diff --git a/logstash-core-event/lib/logstash/util/accessors.rb b/lib/logstash/util/accessors.rb
similarity index 100%
rename from logstash-core-event/lib/logstash/util/accessors.rb
rename to lib/logstash/util/accessors.rb
diff --git a/logstash-core/lib/logstash/util/buftok.rb b/lib/logstash/util/buftok.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/buftok.rb
rename to lib/logstash/util/buftok.rb
diff --git a/logstash-core/lib/logstash/util/byte_value.rb b/lib/logstash/util/byte_value.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/byte_value.rb
rename to lib/logstash/util/byte_value.rb
diff --git a/logstash-core/lib/logstash/util/charset.rb b/lib/logstash/util/charset.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/charset.rb
rename to lib/logstash/util/charset.rb
diff --git a/logstash-core/lib/logstash/util/decorators.rb b/lib/logstash/util/decorators.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/decorators.rb
rename to lib/logstash/util/decorators.rb
diff --git a/logstash-core/lib/logstash/util/duration_formatter.rb b/lib/logstash/util/duration_formatter.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/duration_formatter.rb
rename to lib/logstash/util/duration_formatter.rb
diff --git a/logstash-core/lib/logstash/util/filetools.rb b/lib/logstash/util/filetools.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/filetools.rb
rename to lib/logstash/util/filetools.rb
diff --git a/logstash-core/lib/logstash/util/java_version.rb b/lib/logstash/util/java_version.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/java_version.rb
rename to lib/logstash/util/java_version.rb
diff --git a/logstash-core/lib/logstash/util/loggable.rb b/lib/logstash/util/loggable.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/loggable.rb
rename to lib/logstash/util/loggable.rb
diff --git a/logstash-core/lib/logstash/util/password.rb b/lib/logstash/util/password.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/password.rb
rename to lib/logstash/util/password.rb
diff --git a/logstash-core/lib/logstash/util/plugin_version.rb b/lib/logstash/util/plugin_version.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/plugin_version.rb
rename to lib/logstash/util/plugin_version.rb
diff --git a/logstash-core/lib/logstash/util/prctl.rb b/lib/logstash/util/prctl.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/prctl.rb
rename to lib/logstash/util/prctl.rb
diff --git a/logstash-core/lib/logstash/util/retryable.rb b/lib/logstash/util/retryable.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/retryable.rb
rename to lib/logstash/util/retryable.rb
diff --git a/logstash-core/lib/logstash/util/safe_uri.rb b/lib/logstash/util/safe_uri.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/safe_uri.rb
rename to lib/logstash/util/safe_uri.rb
diff --git a/logstash-core/lib/logstash/util/socket_peer.rb b/lib/logstash/util/socket_peer.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/socket_peer.rb
rename to lib/logstash/util/socket_peer.rb
diff --git a/logstash-core/lib/logstash/util/thread_dump.rb b/lib/logstash/util/thread_dump.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/thread_dump.rb
rename to lib/logstash/util/thread_dump.rb
diff --git a/logstash-core/lib/logstash/util/time_value.rb b/lib/logstash/util/time_value.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/time_value.rb
rename to lib/logstash/util/time_value.rb
diff --git a/logstash-core/lib/logstash/util/unicode_trimmer.rb b/lib/logstash/util/unicode_trimmer.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/unicode_trimmer.rb
rename to lib/logstash/util/unicode_trimmer.rb
diff --git a/logstash-core/lib/logstash/util/worker_threads_default_printer.rb b/lib/logstash/util/worker_threads_default_printer.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/worker_threads_default_printer.rb
rename to lib/logstash/util/worker_threads_default_printer.rb
diff --git a/logstash-core/lib/logstash/util/wrapped_acked_queue.rb b/lib/logstash/util/wrapped_acked_queue.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/wrapped_acked_queue.rb
rename to lib/logstash/util/wrapped_acked_queue.rb
diff --git a/logstash-core/lib/logstash/util/wrapped_synchronous_queue.rb b/lib/logstash/util/wrapped_synchronous_queue.rb
similarity index 100%
rename from logstash-core/lib/logstash/util/wrapped_synchronous_queue.rb
rename to lib/logstash/util/wrapped_synchronous_queue.rb
diff --git a/logstash-core/lib/logstash/version.rb b/lib/logstash/version.rb
similarity index 100%
rename from logstash-core/lib/logstash/version.rb
rename to lib/logstash/version.rb
diff --git a/logstash-core/lib/logstash/webserver.rb b/lib/logstash/webserver.rb
similarity index 100%
rename from logstash-core/lib/logstash/webserver.rb
rename to lib/logstash/webserver.rb
diff --git a/logstash-core-event-java/logstash-core-event-java.gemspec b/logstash-core-event-java.gemspec
similarity index 100%
rename from logstash-core-event-java/logstash-core-event-java.gemspec
rename to logstash-core-event-java.gemspec
diff --git a/logstash-core-event/logstash-core-event.gemspec b/logstash-core-event.gemspec
similarity index 100%
rename from logstash-core-event/logstash-core-event.gemspec
rename to logstash-core-event.gemspec
diff --git a/logstash-core-event/lib/logstash-core-event.rb b/logstash-core-event/lib/logstash-core-event.rb
deleted file mode 100644
index b2979326dac..00000000000
--- a/logstash-core-event/lib/logstash-core-event.rb
+++ /dev/null
@@ -1 +0,0 @@
-require "logstash-core-event/logstash-core-event"
\ No newline at end of file
diff --git a/logstash-core-event/lib/logstash/event.rb b/logstash-core-event/lib/logstash/event.rb
deleted file mode 100644
index de0cf5fc00d..00000000000
--- a/logstash-core-event/lib/logstash/event.rb
+++ /dev/null
@@ -1,292 +0,0 @@
-# encoding: utf-8
-require "time"
-require "date"
-require "cabin"
-require "logstash/namespace"
-require "logstash/util/accessors"
-require "logstash/timestamp"
-require "logstash/json"
-require "logstash/string_interpolation"
-
-# transcient pipeline events for normal in-flow signaling as opposed to
-# flow altering exceptions. for now having base classes is adequate and
-# in the future it might be necessary to refactor using like a BaseEvent
-# class to have a common interface for all pileline events to support
-# eventual queueing persistence for example, TBD.
-
-module LogStash
-  class SignalEvent
-    def flush?; raise "abstract method"; end;
-    def shutdown?; raise "abstract method"; end;
-  end
-
-  class ShutdownEvent < SignalEvent
-    def flush?; false; end;
-    def shutdown?; true; end;
-  end
-
-  class FlushEvent < SignalEvent
-    def flush?; true; end;
-    def shutdown?; false; end;
-  end
-
-  FLUSH = FlushEvent.new
-
-  # LogStash::SHUTDOWN is used by plugins
-  SHUTDOWN = ShutdownEvent.new
-end
-
-# the logstash event object.
-#
-# An event is simply a tuple of (timestamp, data).
-# The 'timestamp' is an ISO8601 timestamp. Data is anything - any message,
-# context, references, etc that are relevant to this event.
-#
-# Internally, this is represented as a hash with only two guaranteed fields.
-#
-# * "@timestamp" - an ISO8601 timestamp representing the time the event
-#   occurred at.
-# * "@version" - the version of the schema. Currently "1"
-#
-# They are prefixed with an "@" symbol to avoid clashing with your
-# own custom fields.
-#
-# When serialized, this is represented in JSON. For example:
-#
-#     {
-#       "@timestamp": "2013-02-09T20:39:26.234Z",
-#       "@version": "1",
-#       message: "hello world"
-#     }
-class LogStash::Event
-  class DeprecatedMethod < StandardError; end
-
-  CHAR_PLUS = "+"
-  TIMESTAMP = "@timestamp"
-  VERSION = "@version"
-  VERSION_ONE = "1"
-  TIMESTAMP_FAILURE_TAG = "_timestampparsefailure"
-  TIMESTAMP_FAILURE_FIELD = "_@timestamp"
-  TAGS = "tags".freeze
-
-  METADATA = "@metadata".freeze
-  METADATA_BRACKETS = "[#{METADATA}]".freeze
-
-  # Floats outside of these upper and lower bounds are forcibly converted
-  # to scientific notation by Float#to_s
-  MIN_FLOAT_BEFORE_SCI_NOT = 0.0001
-  MAX_FLOAT_BEFORE_SCI_NOT = 1000000000000000.0
-
-  DEFAULT_LOGGER = Cabin::Channel.get(LogStash)
-  @@logger = DEFAULT_LOGGER
-
-  def initialize(data = {})
-    @cancelled = false
-    @data = data
-    @accessors = LogStash::Util::Accessors.new(data)
-    @data[VERSION] ||= VERSION_ONE
-    ts = @data[TIMESTAMP]
-    @data[TIMESTAMP] = ts ? init_timestamp(ts) : LogStash::Timestamp.now
-
-    @metadata = @data.delete(METADATA) || {}
-    @metadata_accessors = LogStash::Util::Accessors.new(@metadata)
-  end
-
-  def cancel
-    @cancelled = true
-  end
-
-  def uncancel
-    @cancelled = false
-  end
-
-  def cancelled?
-    @cancelled
-  end
-
-  # Create a deep-ish copy of this event.
-  def clone
-    copy = {}
-    @data.each do |k,v|
-      # TODO(sissel): Recurse if this is a hash/array?
-      copy[k] = begin v.clone rescue v end
-    end
-
-    self.class.new(copy)
-  end
-
-  def to_s
-    "#{timestamp.to_iso8601} #{self.sprintf("%{host} %{message}")}"
-  end
-
-  def timestamp
-    @data[TIMESTAMP]
-  end
-
-  def timestamp=(val)
-    @data[TIMESTAMP] = val
-  end
-
-  def get(fieldref)
-    if fieldref.start_with?(METADATA_BRACKETS)
-      @metadata_accessors.get(fieldref[METADATA_BRACKETS.length .. -1])
-    elsif fieldref == METADATA
-      @metadata
-    else
-      @accessors.get(fieldref)
-    end
-  end
-
-  def set(fieldref, value)
-    if fieldref == TIMESTAMP && !value.is_a?(LogStash::Timestamp)
-      raise TypeError, "The field '@timestamp' must be a (LogStash::Timestamp, not a #{value.class} (#{value})"
-    end
-    if fieldref.start_with?(METADATA_BRACKETS)
-      @metadata_accessors.set(fieldref[METADATA_BRACKETS.length .. -1], value)
-    elsif fieldref == METADATA
-      @metadata = value
-      @metadata_accessors = LogStash::Util::Accessors.new(@metadata)
-    else
-      @accessors.set(fieldref, value)
-    end
-  end
-
-  def to_json(*args)
-    # ignore arguments to respect accepted to_json method signature
-    LogStash::Json.dump(@data)
-  end
-
-  def to_hash
-    @data
-  end
-
-  def overwrite(event)
-    # pickup new event @data and also pickup @accessors
-    # otherwise it will be pointing on previous data
-    @data = event.instance_variable_get(:@data)
-    @accessors = event.instance_variable_get(:@accessors)
-
-    #convert timestamp if it is a String
-    if @data[TIMESTAMP].is_a?(String)
-      @data[TIMESTAMP] = LogStash::Timestamp.parse_iso8601(@data[TIMESTAMP])
-    end
-  end
-
-  def include?(fieldref)
-    if fieldref.start_with?(METADATA_BRACKETS)
-      @metadata_accessors.include?(fieldref[METADATA_BRACKETS.length .. -1])
-    elsif fieldref == METADATA
-      true
-    else
-      @accessors.include?(fieldref)
-    end
-  end
-
-  # Append an event to this one.
-  def append(event)
-    # non-destructively merge that event with ourselves.
-
-    # no need to reset @accessors here because merging will not disrupt any existing field paths
-    # and if new ones are created they will be picked up.
-    LogStash::Util.hash_merge(@data, event.to_hash)
-  end
-
-  # Remove a field or field reference. Returns the value of that field when deleted
-  def remove(fieldref)
-    @accessors.del(fieldref)
-  end
-
-  # sprintf. This could use a better method name.
-  # The idea is to take an event and convert it to a string based on
-  # any format values, delimited by %{foo} where 'foo' is a field or
-  # metadata member.
-  #
-  # For example, if the event has type == "foo" and host == "bar"
-  # then this string:
-  #   "type is %{type} and source is %{host}"
-  # will return
-  #   "type is foo and source is bar"
-  #
-  # If a %{name} value is an array, then we will join by ','
-  # If a %{name} value does not exist, then no substitution occurs.
-  def sprintf(format)
-    LogStash::StringInterpolation.evaluate(self, format)
-  end
-
-  def tag(value)
-    # Generalize this method for more usability
-    tags = @accessors.get(TAGS) || []
-    tags << value unless tags.include?(value)
-    @accessors.set(TAGS, tags)
-  end
-
-  def to_hash_with_metadata
-    @metadata.empty? ? to_hash : to_hash.merge(METADATA => @metadata)
-  end
-
-  def to_json_with_metadata(*args)
-    # ignore arguments to respect accepted to_json method signature
-    LogStash::Json.dump(to_hash_with_metadata)
-  end
-
-  # this is used by logstash-devutils spec_helper.rb to monkey patch the Event field setter []=
-  # and add systematic encoding validation on every field set in specs.
-  # TODO: (colin) this should be moved, probably in logstash-devutils ?
-  def self.validate_value(value)
-    case value
-    when String
-      raise("expected UTF-8 encoding for value=#{value}, encoding=#{value.encoding.inspect}") unless value.encoding == Encoding::UTF_8
-      raise("invalid UTF-8 encoding for value=#{value}, encoding=#{value.encoding.inspect}") unless value.valid_encoding?
-      value
-    when Array
-      value.each{|v| validate_value(v)} # don't map, return original object
-      value
-    else
-      value
-    end
-  end
-
-  # depracated public methods
-  # TODO: (colin) since these depracated mothods are still exposed in 2.x we should remove them in 3.0
-
-  def unix_timestamp
-    raise DeprecatedMethod
-  end
-
-  def ruby_timestamp
-    raise DeprecatedMethod
-  end
-
-  def fields
-    raise DeprecatedMethod
-  end
-
-  # set a new logger for all Event instances
-  # there is no point in changing it at runtime for other reasons than in tests/specs.
-  # @param logger [Cabin::Channel] logger instance that will be used by all Event instances
-  def self.logger=(logger)
-    @@logger = logger
-  end
-
-  private
-
-  def logger
-    @@logger
-  end
-
-  def init_timestamp(o)
-    begin
-      timestamp = LogStash::Timestamp.coerce(o)
-      return timestamp if timestamp
-
-      logger.warn("Unrecognized #{TIMESTAMP} value, setting current time to #{TIMESTAMP}, original in #{TIMESTAMP_FAILURE_FIELD}field", :value => o.inspect)
-    rescue LogStash::TimestampParserError => e
-      logger.warn("Error parsing #{TIMESTAMP} string, setting current time to #{TIMESTAMP}, original in #{TIMESTAMP_FAILURE_FIELD} field", :value => o.inspect, :exception => e.message)
-    end
-
-    tag(TIMESTAMP_FAILURE_TAG)
-    @accessors.set(TIMESTAMP_FAILURE_FIELD, o)
-
-    LogStash::Timestamp.now
-  end
-end
diff --git a/logstash-core-event/lib/logstash/string_interpolation.rb b/logstash-core-event/lib/logstash/string_interpolation.rb
deleted file mode 100644
index aaa54981165..00000000000
--- a/logstash-core-event/lib/logstash/string_interpolation.rb
+++ /dev/null
@@ -1,152 +0,0 @@
-# encoding: utf-8
-require "thread_safe"
-require "forwardable"
-
-module LogStash
-  module StringInterpolation
-    extend self
-
-    # Floats outside of these upper and lower bounds are forcibly converted
-    # to scientific notation by Float#to_s
-    MIN_FLOAT_BEFORE_SCI_NOT = 0.0001
-    MAX_FLOAT_BEFORE_SCI_NOT = 1000000000000000.0
-
-    CACHE = ThreadSafe::Cache.new
-    TEMPLATE_TAG_REGEXP = /%\{[^}]+\}/
-
-    def evaluate(event, template)
-      if template.is_a?(Float) && (template < MIN_FLOAT_BEFORE_SCI_NOT || template >= MAX_FLOAT_BEFORE_SCI_NOT)
-        return ("%.15f" % template).sub(/0*$/,"")
-      end
-
-      template = template.to_s
-
-      return template if not_cachable?(template)
-
-      compiled = CACHE.get_or_default(template, nil) || CACHE.put(template, compile_template(template))
-      compiled.evaluate(event)
-    end
-
-    # clear the global compiled templates cache
-    def clear_cache
-      CACHE.clear
-    end
-
-    # @return [Fixnum] the compiled templates cache size
-    def cache_size
-      CACHE.size
-    end
-
-    private
-    def not_cachable?(template)
-      template.index("%").nil?
-    end
-
-    def compile_template(template)
-      nodes = Template.new
-
-      position = 0
-      matches = template.to_enum(:scan, TEMPLATE_TAG_REGEXP).map { |m| $~ }
-
-      matches.each do |match|
-        tag = match[0][2..-2]
-        start = match.offset(0).first
-        nodes << StaticNode.new(template[position..(start-1)]) if start > 0
-        nodes << identify(tag)
-        position = match.offset(0).last
-      end
-
-      if position < template.size
-        nodes << StaticNode.new(template[position..-1])
-      end
-
-      optimize(nodes)
-    end
-
-    def optimize(nodes)
-      nodes.size == 1 ?  nodes.first : nodes
-    end
-
-    def identify(tag)
-      if tag == "+%s"
-        EpocNode.new
-      elsif tag[0, 1] == "+"
-        DateNode.new(tag[1..-1])
-      else
-        KeyNode.new(tag)
-      end
-    end
-  end
-
-  class Template
-    extend Forwardable
-    def_delegators :@nodes, :<<, :push, :size, :first
-
-    def initialize
-      @nodes = []
-    end
-
-    def evaluate(event)
-      @nodes.collect { |node| node.evaluate(event) }.join
-    end
-  end
-
-  class EpocNode
-    def evaluate(event)
-      t = event.timestamp
-      raise LogStash::Error, "Unable to format in string \"#{@format}\", #{LogStash::Event::TIMESTAMP} field not found" unless t
-      t.to_i.to_s
-    end
-  end
-
-  class StaticNode
-    def initialize(content)
-      @content = content
-    end
-
-    def evaluate(event)
-      @content
-    end
-  end
-
-  class KeyNode
-    def initialize(key)
-      @key = key
-    end
-
-    def evaluate(event)
-      value = event.get(@key)
-
-      case value
-      when nil
-        "%{#{@key}}"
-      when Array
-        value.join(",")
-      when Hash
-        LogStash::Json.dump(value)
-      else
-        # Make sure we dont work on the refence of the value
-        # The Java Event implementation was always returning a string.
-        "#{value}"
-      end
-    end
-  end
-
-  class DateNode
-    def initialize(format)
-      @format = format
-      @formatter = org.joda.time.format.DateTimeFormat.forPattern(@format)
-          .withZone(org.joda.time.DateTimeZone::UTC)
-    end
-
-    def evaluate(event)
-      t = event.timestamp
-
-      raise LogStash::Error, "Unable to format in string \"#{@format}\", #{LogStash::Event::TIMESTAMP} field not found" unless t
-
-      org.joda.time.Instant.java_class.constructor(Java::long).new_instance(
-        t.tv_sec * 1000 + t.tv_usec / 1000
-      ).to_java.toDateTime.toString(@formatter)
-    end
-  end
-end
diff --git a/logstash-core-event/lib/logstash/timestamp.rb b/logstash-core-event/lib/logstash/timestamp.rb
deleted file mode 100644
index ab6b6edb3bc..00000000000
--- a/logstash-core-event/lib/logstash/timestamp.rb
+++ /dev/null
@@ -1,103 +0,0 @@
-# encoding: utf-8
-require "logstash/environment"
-require "logstash/json"
-require "forwardable"
-require "date"
-require "time"
-
-module LogStash
-  class TimestampParserError < StandardError; end
-
-  class Timestamp
-    extend Forwardable
-    include Comparable
-
-    def_delegators :@time, :tv_usec, :usec, :year, :iso8601, :to_i, :tv_sec, :to_f, :to_edn, :<=>, :+
-
-    attr_reader :time
-
-    ISO8601_STRFTIME = "%04d-%02d-%02dT%02d:%02d:%02d.%06d%+03d:00".freeze
-    ISO8601_PRECISION = 3
-
-    def initialize(time = Time.new)
-      @time = time.utc
-    end
-
-    def self.at(*args)
-      epoch = args.first
-      if epoch.is_a?(BigDecimal)
-        # bug in JRuby prevents correcly parsing a BigDecimal fractional part, see https://github.com/elastic/logstash/issues/4565
-        Timestamp.new(::Time.at(epoch.to_i, epoch.frac.to_f * 1000000))
-      else
-        Timestamp.new(::Time.at(*args))
-      end
-    end
-
-    def self.parse(*args)
-      Timestamp.new(::Time.parse(*args))
-    end
-
-    def self.now
-      Timestamp.new(::Time.now)
-    end
-
-    # coerce tries different strategies based on the time object class to convert into a Timestamp.
-    # @param [String, Time, Timestamp] time the time object to try coerce
-    # @return [Timestamp, nil] Timestamp will be returned if successful otherwise nil
-    # @raise [TimestampParserError] on String with invalid format
-    def self.coerce(time)
-      case time
-      when String
-        LogStash::Timestamp.parse_iso8601(time)
-      when LogStash::Timestamp
-        time
-      when Time
-        LogStash::Timestamp.new(time)
-      else
-        nil
-      end
-    end
-
-    if LogStash::Environment.jruby?
-      JODA_ISO8601_PARSER = org.joda.time.format.ISODateTimeFormat.dateTimeParser
-      UTC = org.joda.time.DateTimeZone.forID("UTC")
-
-      def self.parse_iso8601(t)
-        millis = JODA_ISO8601_PARSER.parseMillis(t)
-        LogStash::Timestamp.at(millis / 1000, (millis % 1000) * 1000)
-      rescue => e
-        raise(TimestampParserError, "invalid timestamp string #{t.inspect}, error=#{e.inspect}")
-      end
-
-    else
-
-      def self.parse_iso8601(t)
-        # warning, ruby's Time.parse is *really* terrible and slow.
-        LogStash::Timestamp.new(::Time.parse(t))
-      rescue => e
-        raise(TimestampParserError, "invalid timestamp string #{t.inspect}, error=#{e.inspect}")
-      end
-    end
-
-    def utc
-      @time.utc # modifies the receiver
-      self
-    end
-    alias_method :gmtime, :utc
-
-    def to_json(*args)
-      # ignore arguments to respect accepted to_json method signature
-      "\"" + to_iso8601 + "\""
-    end
-    alias_method :inspect, :to_json
-
-    def to_iso8601
-      @iso8601 ||= @time.iso8601(ISO8601_PRECISION)
-    end
-    alias_method :to_s, :to_iso8601
-
-    def -(value)
-      @time - (value.is_a?(Timestamp) ? value.time : value)
-    end
-  end
-end
diff --git a/logstash-core-plugin-api/logstash-core-plugin-api.gemspec b/logstash-core-plugin-api.gemspec
similarity index 100%
rename from logstash-core-plugin-api/logstash-core-plugin-api.gemspec
rename to logstash-core-plugin-api.gemspec
diff --git a/logstash-core-queue-jruby/logstash-core-queue-jruby.gemspec b/logstash-core-queue-jruby.gemspec
similarity index 100%
rename from logstash-core-queue-jruby/logstash-core-queue-jruby.gemspec
rename to logstash-core-queue-jruby.gemspec
diff --git a/logstash-core/logstash-core.gemspec b/logstash-core.gemspec
similarity index 100%
rename from logstash-core/logstash-core.gemspec
rename to logstash-core.gemspec
diff --git a/logstash-core/spec/api/lib/api/logging_spec.rb b/spec/api/lib/api/logging_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/logging_spec.rb
rename to spec/api/lib/api/logging_spec.rb
diff --git a/logstash-core/spec/api/lib/api/node_plugins_spec.rb b/spec/api/lib/api/node_plugins_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/node_plugins_spec.rb
rename to spec/api/lib/api/node_plugins_spec.rb
diff --git a/logstash-core/spec/api/lib/api/node_spec.rb b/spec/api/lib/api/node_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/node_spec.rb
rename to spec/api/lib/api/node_spec.rb
diff --git a/logstash-core/spec/api/lib/api/node_stats_spec.rb b/spec/api/lib/api/node_stats_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/node_stats_spec.rb
rename to spec/api/lib/api/node_stats_spec.rb
diff --git a/logstash-core/spec/api/lib/api/plugins_spec.rb b/spec/api/lib/api/plugins_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/plugins_spec.rb
rename to spec/api/lib/api/plugins_spec.rb
diff --git a/logstash-core/spec/api/lib/api/root_spec.rb b/spec/api/lib/api/root_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/root_spec.rb
rename to spec/api/lib/api/root_spec.rb
diff --git a/logstash-core/spec/api/lib/api/support/resource_dsl_methods.rb b/spec/api/lib/api/support/resource_dsl_methods.rb
similarity index 100%
rename from logstash-core/spec/api/lib/api/support/resource_dsl_methods.rb
rename to spec/api/lib/api/support/resource_dsl_methods.rb
diff --git a/logstash-core/spec/api/lib/commands/stats.rb b/spec/api/lib/commands/stats.rb
similarity index 100%
rename from logstash-core/spec/api/lib/commands/stats.rb
rename to spec/api/lib/commands/stats.rb
diff --git a/logstash-core/spec/api/lib/errors_spec.rb b/spec/api/lib/errors_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/errors_spec.rb
rename to spec/api/lib/errors_spec.rb
diff --git a/logstash-core/spec/api/lib/rack_app_spec.rb b/spec/api/lib/rack_app_spec.rb
similarity index 100%
rename from logstash-core/spec/api/lib/rack_app_spec.rb
rename to spec/api/lib/rack_app_spec.rb
diff --git a/logstash-core/spec/api/spec_helper.rb b/spec/api/spec_helper.rb
similarity index 100%
rename from logstash-core/spec/api/spec_helper.rb
rename to spec/api/spec_helper.rb
diff --git a/logstash-core/spec/conditionals_spec.rb b/spec/conditionals_spec.rb
similarity index 100%
rename from logstash-core/spec/conditionals_spec.rb
rename to spec/conditionals_spec.rb
diff --git a/logstash-core-event-java/spec/event_spec.rb b/spec/event_spec.rb
similarity index 100%
rename from logstash-core-event-java/spec/event_spec.rb
rename to spec/event_spec.rb
diff --git a/logstash-core/spec/logstash/agent_spec.rb b/spec/logstash/agent_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/agent_spec.rb
rename to spec/logstash/agent_spec.rb
diff --git a/logstash-core/spec/logstash/codecs/base_spec.rb b/spec/logstash/codecs/base_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/codecs/base_spec.rb
rename to spec/logstash/codecs/base_spec.rb
diff --git a/logstash-core/spec/logstash/config/config_ast_spec.rb b/spec/logstash/config/config_ast_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/config/config_ast_spec.rb
rename to spec/logstash/config/config_ast_spec.rb
diff --git a/logstash-core/spec/logstash/config/cpu_core_strategy_spec.rb b/spec/logstash/config/cpu_core_strategy_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/config/cpu_core_strategy_spec.rb
rename to spec/logstash/config/cpu_core_strategy_spec.rb
diff --git a/logstash-core/spec/logstash/config/defaults_spec.rb b/spec/logstash/config/defaults_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/config/defaults_spec.rb
rename to spec/logstash/config/defaults_spec.rb
diff --git a/logstash-core/spec/logstash/config/loader_spec.rb b/spec/logstash/config/loader_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/config/loader_spec.rb
rename to spec/logstash/config/loader_spec.rb
diff --git a/logstash-core/spec/logstash/config/mixin_spec.rb b/spec/logstash/config/mixin_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/config/mixin_spec.rb
rename to spec/logstash/config/mixin_spec.rb
diff --git a/logstash-core/spec/logstash/environment_spec.rb b/spec/logstash/environment_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/environment_spec.rb
rename to spec/logstash/environment_spec.rb
diff --git a/logstash-core/spec/logstash/event_dispatcher_spec.rb b/spec/logstash/event_dispatcher_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/event_dispatcher_spec.rb
rename to spec/logstash/event_dispatcher_spec.rb
diff --git a/logstash-core-event/spec/logstash/event_spec.rb b/spec/logstash/event_spec.rb
similarity index 100%
rename from logstash-core-event/spec/logstash/event_spec.rb
rename to spec/logstash/event_spec.rb
diff --git a/logstash-core/spec/logstash/filter_delegator_spec.rb b/spec/logstash/filter_delegator_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/filter_delegator_spec.rb
rename to spec/logstash/filter_delegator_spec.rb
diff --git a/logstash-core/spec/logstash/filters/base_spec.rb b/spec/logstash/filters/base_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/filters/base_spec.rb
rename to spec/logstash/filters/base_spec.rb
diff --git a/logstash-core/spec/logstash/inputs/base_spec.rb b/spec/logstash/inputs/base_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/inputs/base_spec.rb
rename to spec/logstash/inputs/base_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/collector_spec.rb b/spec/logstash/instrument/collector_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/collector_spec.rb
rename to spec/logstash/instrument/collector_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/metric_spec.rb b/spec/logstash/instrument/metric_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/metric_spec.rb
rename to spec/logstash/instrument/metric_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/metric_store_spec.rb b/spec/logstash/instrument/metric_store_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/metric_store_spec.rb
rename to spec/logstash/instrument/metric_store_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/metric_type/counter_spec.rb b/spec/logstash/instrument/metric_type/counter_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/metric_type/counter_spec.rb
rename to spec/logstash/instrument/metric_type/counter_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/metric_type/gauge_spec.rb b/spec/logstash/instrument/metric_type/gauge_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/metric_type/gauge_spec.rb
rename to spec/logstash/instrument/metric_type/gauge_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/namespaced_metric_spec.rb b/spec/logstash/instrument/namespaced_metric_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/namespaced_metric_spec.rb
rename to spec/logstash/instrument/namespaced_metric_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/namespaced_null_metric_spec.rb b/spec/logstash/instrument/namespaced_null_metric_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/namespaced_null_metric_spec.rb
rename to spec/logstash/instrument/namespaced_null_metric_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/null_metric_spec.rb b/spec/logstash/instrument/null_metric_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/null_metric_spec.rb
rename to spec/logstash/instrument/null_metric_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/periodic_poller/base_spec.rb b/spec/logstash/instrument/periodic_poller/base_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/periodic_poller/base_spec.rb
rename to spec/logstash/instrument/periodic_poller/base_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/periodic_poller/cgroup_spec.rb b/spec/logstash/instrument/periodic_poller/cgroup_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/periodic_poller/cgroup_spec.rb
rename to spec/logstash/instrument/periodic_poller/cgroup_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/periodic_poller/jvm_spec.rb b/spec/logstash/instrument/periodic_poller/jvm_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/periodic_poller/jvm_spec.rb
rename to spec/logstash/instrument/periodic_poller/jvm_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/periodic_poller/load_average_spec.rb b/spec/logstash/instrument/periodic_poller/load_average_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/periodic_poller/load_average_spec.rb
rename to spec/logstash/instrument/periodic_poller/load_average_spec.rb
diff --git a/logstash-core/spec/logstash/instrument/periodic_poller/os_spec.rb b/spec/logstash/instrument/periodic_poller/os_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/instrument/periodic_poller/os_spec.rb
rename to spec/logstash/instrument/periodic_poller/os_spec.rb
diff --git a/logstash-core/spec/logstash/java_integration_spec.rb b/spec/logstash/java_integration_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/java_integration_spec.rb
rename to spec/logstash/java_integration_spec.rb
diff --git a/logstash-core/spec/logstash/json_spec.rb b/spec/logstash/json_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/json_spec.rb
rename to spec/logstash/json_spec.rb
diff --git a/logstash-core/spec/logstash/output_delegator_spec.rb b/spec/logstash/output_delegator_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/output_delegator_spec.rb
rename to spec/logstash/output_delegator_spec.rb
diff --git a/logstash-core/spec/logstash/outputs/base_spec.rb b/spec/logstash/outputs/base_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/outputs/base_spec.rb
rename to spec/logstash/outputs/base_spec.rb
diff --git a/logstash-core/spec/logstash/patches_spec.rb b/spec/logstash/patches_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/patches_spec.rb
rename to spec/logstash/patches_spec.rb
diff --git a/logstash-core/spec/logstash/pipeline_pq_file_spec.rb b/spec/logstash/pipeline_pq_file_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/pipeline_pq_file_spec.rb
rename to spec/logstash/pipeline_pq_file_spec.rb
diff --git a/logstash-core/spec/logstash/pipeline_reporter_spec.rb b/spec/logstash/pipeline_reporter_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/pipeline_reporter_spec.rb
rename to spec/logstash/pipeline_reporter_spec.rb
diff --git a/logstash-core/spec/logstash/pipeline_spec.rb b/spec/logstash/pipeline_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/pipeline_spec.rb
rename to spec/logstash/pipeline_spec.rb
diff --git a/logstash-core/spec/logstash/plugin_spec.rb b/spec/logstash/plugin_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/plugin_spec.rb
rename to spec/logstash/plugin_spec.rb
diff --git a/logstash-core/spec/logstash/plugins/hooks_registry_spec.rb b/spec/logstash/plugins/hooks_registry_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/plugins/hooks_registry_spec.rb
rename to spec/logstash/plugins/hooks_registry_spec.rb
diff --git a/logstash-core/spec/logstash/plugins/registry_spec.rb b/spec/logstash/plugins/registry_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/plugins/registry_spec.rb
rename to spec/logstash/plugins/registry_spec.rb
diff --git a/logstash-core/spec/logstash/runner_spec.rb b/spec/logstash/runner_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/runner_spec.rb
rename to spec/logstash/runner_spec.rb
diff --git a/logstash-core/spec/logstash/setting_spec.rb b/spec/logstash/setting_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/setting_spec.rb
rename to spec/logstash/setting_spec.rb
diff --git a/logstash-core/spec/logstash/settings/bytes_spec.rb b/spec/logstash/settings/bytes_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/bytes_spec.rb
rename to spec/logstash/settings/bytes_spec.rb
diff --git a/logstash-core/spec/logstash/settings/integer_spec.rb b/spec/logstash/settings/integer_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/integer_spec.rb
rename to spec/logstash/settings/integer_spec.rb
diff --git a/logstash-core/spec/logstash/settings/numeric_spec.rb b/spec/logstash/settings/numeric_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/numeric_spec.rb
rename to spec/logstash/settings/numeric_spec.rb
diff --git a/logstash-core/spec/logstash/settings/port_range_spec.rb b/spec/logstash/settings/port_range_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/port_range_spec.rb
rename to spec/logstash/settings/port_range_spec.rb
diff --git a/logstash-core/spec/logstash/settings/string_spec.rb b/spec/logstash/settings/string_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/string_spec.rb
rename to spec/logstash/settings/string_spec.rb
diff --git a/logstash-core/spec/logstash/settings/time_value_spec.rb b/spec/logstash/settings/time_value_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/time_value_spec.rb
rename to spec/logstash/settings/time_value_spec.rb
diff --git a/logstash-core/spec/logstash/settings/writable_directory_spec.rb b/spec/logstash/settings/writable_directory_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings/writable_directory_spec.rb
rename to spec/logstash/settings/writable_directory_spec.rb
diff --git a/logstash-core/spec/logstash/settings_spec.rb b/spec/logstash/settings_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/settings_spec.rb
rename to spec/logstash/settings_spec.rb
diff --git a/logstash-core/spec/logstash/shutdown_watcher_spec.rb b/spec/logstash/shutdown_watcher_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/shutdown_watcher_spec.rb
rename to spec/logstash/shutdown_watcher_spec.rb
diff --git a/logstash-core-event/spec/logstash/timestamp_spec.rb b/spec/logstash/timestamp_spec.rb
similarity index 100%
rename from logstash-core-event/spec/logstash/timestamp_spec.rb
rename to spec/logstash/timestamp_spec.rb
diff --git a/logstash-core-event/spec/logstash/util/accessors_spec.rb b/spec/logstash/util/accessors_spec.rb
similarity index 100%
rename from logstash-core-event/spec/logstash/util/accessors_spec.rb
rename to spec/logstash/util/accessors_spec.rb
diff --git a/logstash-core/spec/logstash/util/buftok_spec.rb b/spec/logstash/util/buftok_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/buftok_spec.rb
rename to spec/logstash/util/buftok_spec.rb
diff --git a/logstash-core/spec/logstash/util/byte_value_spec.rb b/spec/logstash/util/byte_value_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/byte_value_spec.rb
rename to spec/logstash/util/byte_value_spec.rb
diff --git a/logstash-core/spec/logstash/util/charset_spec.rb b/spec/logstash/util/charset_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/charset_spec.rb
rename to spec/logstash/util/charset_spec.rb
diff --git a/logstash-core/spec/logstash/util/duration_formatter_spec.rb b/spec/logstash/util/duration_formatter_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/duration_formatter_spec.rb
rename to spec/logstash/util/duration_formatter_spec.rb
diff --git a/logstash-core/spec/logstash/util/java_version_spec.rb b/spec/logstash/util/java_version_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/java_version_spec.rb
rename to spec/logstash/util/java_version_spec.rb
diff --git a/logstash-core/spec/logstash/util/plugin_version_spec.rb b/spec/logstash/util/plugin_version_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/plugin_version_spec.rb
rename to spec/logstash/util/plugin_version_spec.rb
diff --git a/logstash-core/spec/logstash/util/time_value_spec.rb b/spec/logstash/util/time_value_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/time_value_spec.rb
rename to spec/logstash/util/time_value_spec.rb
diff --git a/logstash-core/spec/logstash/util/unicode_trimmer_spec.rb b/spec/logstash/util/unicode_trimmer_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/unicode_trimmer_spec.rb
rename to spec/logstash/util/unicode_trimmer_spec.rb
diff --git a/logstash-core/spec/logstash/util/wrapped_synchronous_queue_spec.rb b/spec/logstash/util/wrapped_synchronous_queue_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util/wrapped_synchronous_queue_spec.rb
rename to spec/logstash/util/wrapped_synchronous_queue_spec.rb
diff --git a/logstash-core/spec/logstash/util_spec.rb b/spec/logstash/util_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/util_spec.rb
rename to spec/logstash/util_spec.rb
diff --git a/logstash-core/spec/logstash/webserver_spec.rb b/spec/logstash/webserver_spec.rb
similarity index 100%
rename from logstash-core/spec/logstash/webserver_spec.rb
rename to spec/logstash/webserver_spec.rb
diff --git a/logstash-core/spec/static/i18n_spec.rb b/spec/static/i18n_spec.rb
similarity index 100%
rename from logstash-core/spec/static/i18n_spec.rb
rename to spec/static/i18n_spec.rb
diff --git a/logstash-core/spec/support/helpers.rb b/spec/support/helpers.rb
similarity index 100%
rename from logstash-core/spec/support/helpers.rb
rename to spec/support/helpers.rb
diff --git a/logstash-core/spec/support/matchers.rb b/spec/support/matchers.rb
similarity index 100%
rename from logstash-core/spec/support/matchers.rb
rename to spec/support/matchers.rb
diff --git a/logstash-core/spec/support/mocks_classes.rb b/spec/support/mocks_classes.rb
similarity index 100%
rename from logstash-core/spec/support/mocks_classes.rb
rename to spec/support/mocks_classes.rb
diff --git a/logstash-core/spec/support/shared_examples.rb b/spec/support/shared_examples.rb
similarity index 100%
rename from logstash-core/spec/support/shared_examples.rb
rename to spec/support/shared_examples.rb
diff --git a/logstash-core-event-java/spec/timestamp_spec.rb b/spec/timestamp_spec.rb
similarity index 100%
rename from logstash-core-event-java/spec/timestamp_spec.rb
rename to spec/timestamp_spec.rb
diff --git a/logstash-core-queue-jruby/src/main/java/JrubyAckedBatchExtService.java b/src/main/java/JrubyAckedBatchExtService.java
similarity index 100%
rename from logstash-core-queue-jruby/src/main/java/JrubyAckedBatchExtService.java
rename to src/main/java/JrubyAckedBatchExtService.java
diff --git a/logstash-core-queue-jruby/src/main/java/JrubyAckedQueueExtService.java b/src/main/java/JrubyAckedQueueExtService.java
similarity index 100%
rename from logstash-core-queue-jruby/src/main/java/JrubyAckedQueueExtService.java
rename to src/main/java/JrubyAckedQueueExtService.java
diff --git a/logstash-core-event-java/src/main/java/JrubyEventExtService.java b/src/main/java/JrubyEventExtService.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/JrubyEventExtService.java
rename to src/main/java/JrubyEventExtService.java
diff --git a/logstash-core-event-java/src/main/java/JrubyTimestampExtService.java b/src/main/java/JrubyTimestampExtService.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/JrubyTimestampExtService.java
rename to src/main/java/JrubyTimestampExtService.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Accessors.java b/src/main/java/org/logstash/Accessors.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Accessors.java
rename to src/main/java/org/logstash/Accessors.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Cloner.java b/src/main/java/org/logstash/Cloner.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Cloner.java
rename to src/main/java/org/logstash/Cloner.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/ConvertedList.java b/src/main/java/org/logstash/ConvertedList.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/ConvertedList.java
rename to src/main/java/org/logstash/ConvertedList.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/ConvertedMap.java b/src/main/java/org/logstash/ConvertedMap.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/ConvertedMap.java
rename to src/main/java/org/logstash/ConvertedMap.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/DateNode.java b/src/main/java/org/logstash/DateNode.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/DateNode.java
rename to src/main/java/org/logstash/DateNode.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/EpochNode.java b/src/main/java/org/logstash/EpochNode.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/EpochNode.java
rename to src/main/java/org/logstash/EpochNode.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Event.java b/src/main/java/org/logstash/Event.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Event.java
rename to src/main/java/org/logstash/Event.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/FieldReference.java b/src/main/java/org/logstash/FieldReference.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/FieldReference.java
rename to src/main/java/org/logstash/FieldReference.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Javafier.java b/src/main/java/org/logstash/Javafier.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Javafier.java
rename to src/main/java/org/logstash/Javafier.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/KeyNode.java b/src/main/java/org/logstash/KeyNode.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/KeyNode.java
rename to src/main/java/org/logstash/KeyNode.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/ObjectMappers.java b/src/main/java/org/logstash/ObjectMappers.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/ObjectMappers.java
rename to src/main/java/org/logstash/ObjectMappers.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/PathCache.java b/src/main/java/org/logstash/PathCache.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/PathCache.java
rename to src/main/java/org/logstash/PathCache.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Rubyfier.java b/src/main/java/org/logstash/Rubyfier.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Rubyfier.java
rename to src/main/java/org/logstash/Rubyfier.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/StaticNode.java b/src/main/java/org/logstash/StaticNode.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/StaticNode.java
rename to src/main/java/org/logstash/StaticNode.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/StringInterpolation.java b/src/main/java/org/logstash/StringInterpolation.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/StringInterpolation.java
rename to src/main/java/org/logstash/StringInterpolation.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Template.java b/src/main/java/org/logstash/Template.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Template.java
rename to src/main/java/org/logstash/Template.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/TemplateNode.java b/src/main/java/org/logstash/TemplateNode.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/TemplateNode.java
rename to src/main/java/org/logstash/TemplateNode.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Timestamp.java b/src/main/java/org/logstash/Timestamp.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Timestamp.java
rename to src/main/java/org/logstash/Timestamp.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/TimestampSerializer.java b/src/main/java/org/logstash/TimestampSerializer.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/TimestampSerializer.java
rename to src/main/java/org/logstash/TimestampSerializer.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Util.java b/src/main/java/org/logstash/Util.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Util.java
rename to src/main/java/org/logstash/Util.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/Valuefier.java b/src/main/java/org/logstash/Valuefier.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/Valuefier.java
rename to src/main/java/org/logstash/Valuefier.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Batch.java b/src/main/java/org/logstash/ackedqueue/Batch.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Batch.java
rename to src/main/java/org/logstash/ackedqueue/Batch.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Checkpoint.java b/src/main/java/org/logstash/ackedqueue/Checkpoint.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Checkpoint.java
rename to src/main/java/org/logstash/ackedqueue/Checkpoint.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/FileSettings.java b/src/main/java/org/logstash/ackedqueue/FileSettings.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/FileSettings.java
rename to src/main/java/org/logstash/ackedqueue/FileSettings.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/HeadPage.java b/src/main/java/org/logstash/ackedqueue/HeadPage.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/HeadPage.java
rename to src/main/java/org/logstash/ackedqueue/HeadPage.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/MemorySettings.java b/src/main/java/org/logstash/ackedqueue/MemorySettings.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/MemorySettings.java
rename to src/main/java/org/logstash/ackedqueue/MemorySettings.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Page.java b/src/main/java/org/logstash/ackedqueue/Page.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Page.java
rename to src/main/java/org/logstash/ackedqueue/Page.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Queue.java b/src/main/java/org/logstash/ackedqueue/Queue.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Queue.java
rename to src/main/java/org/logstash/ackedqueue/Queue.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/QueueRuntimeException.java b/src/main/java/org/logstash/ackedqueue/QueueRuntimeException.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/QueueRuntimeException.java
rename to src/main/java/org/logstash/ackedqueue/QueueRuntimeException.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Queueable.java b/src/main/java/org/logstash/ackedqueue/Queueable.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Queueable.java
rename to src/main/java/org/logstash/ackedqueue/Queueable.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/SequencedList.java b/src/main/java/org/logstash/ackedqueue/SequencedList.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/SequencedList.java
rename to src/main/java/org/logstash/ackedqueue/SequencedList.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/Settings.java b/src/main/java/org/logstash/ackedqueue/Settings.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/Settings.java
rename to src/main/java/org/logstash/ackedqueue/Settings.java
diff --git a/logstash-core/src/main/java/org/logstash/ackedqueue/TailPage.java b/src/main/java/org/logstash/ackedqueue/TailPage.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/ackedqueue/TailPage.java
rename to src/main/java/org/logstash/ackedqueue/TailPage.java
diff --git a/logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedBatchExtLibrary.java b/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedBatchExtLibrary.java
similarity index 100%
rename from logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedBatchExtLibrary.java
rename to src/main/java/org/logstash/ackedqueue/ext/JrubyAckedBatchExtLibrary.java
diff --git a/logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueExtLibrary.java b/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueExtLibrary.java
similarity index 100%
rename from logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueExtLibrary.java
rename to src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueExtLibrary.java
diff --git a/logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueMemoryExtLibrary.java b/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueMemoryExtLibrary.java
similarity index 100%
rename from logstash-core-queue-jruby/src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueMemoryExtLibrary.java
rename to src/main/java/org/logstash/ackedqueue/ext/JrubyAckedQueueMemoryExtLibrary.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValue.java b/src/main/java/org/logstash/bivalues/BiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValue.java
rename to src/main/java/org/logstash/bivalues/BiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValueCommon.java b/src/main/java/org/logstash/bivalues/BiValueCommon.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValueCommon.java
rename to src/main/java/org/logstash/bivalues/BiValueCommon.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValues.java b/src/main/java/org/logstash/bivalues/BiValues.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BiValues.java
rename to src/main/java/org/logstash/bivalues/BiValues.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BigDecimalBiValue.java b/src/main/java/org/logstash/bivalues/BigDecimalBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BigDecimalBiValue.java
rename to src/main/java/org/logstash/bivalues/BigDecimalBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BigIntegerBiValue.java b/src/main/java/org/logstash/bivalues/BigIntegerBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BigIntegerBiValue.java
rename to src/main/java/org/logstash/bivalues/BigIntegerBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/BooleanBiValue.java b/src/main/java/org/logstash/bivalues/BooleanBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/BooleanBiValue.java
rename to src/main/java/org/logstash/bivalues/BooleanBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/DoubleBiValue.java b/src/main/java/org/logstash/bivalues/DoubleBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/DoubleBiValue.java
rename to src/main/java/org/logstash/bivalues/DoubleBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/FloatBiValue.java b/src/main/java/org/logstash/bivalues/FloatBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/FloatBiValue.java
rename to src/main/java/org/logstash/bivalues/FloatBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/IntegerBiValue.java b/src/main/java/org/logstash/bivalues/IntegerBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/IntegerBiValue.java
rename to src/main/java/org/logstash/bivalues/IntegerBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/JavaProxyBiValue.java b/src/main/java/org/logstash/bivalues/JavaProxyBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/JavaProxyBiValue.java
rename to src/main/java/org/logstash/bivalues/JavaProxyBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/LongBiValue.java b/src/main/java/org/logstash/bivalues/LongBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/LongBiValue.java
rename to src/main/java/org/logstash/bivalues/LongBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/NullBiValue.java b/src/main/java/org/logstash/bivalues/NullBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/NullBiValue.java
rename to src/main/java/org/logstash/bivalues/NullBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/StringBiValue.java b/src/main/java/org/logstash/bivalues/StringBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/StringBiValue.java
rename to src/main/java/org/logstash/bivalues/StringBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/SymbolBiValue.java b/src/main/java/org/logstash/bivalues/SymbolBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/SymbolBiValue.java
rename to src/main/java/org/logstash/bivalues/SymbolBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/TimeBiValue.java b/src/main/java/org/logstash/bivalues/TimeBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/TimeBiValue.java
rename to src/main/java/org/logstash/bivalues/TimeBiValue.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/bivalues/TimestampBiValue.java b/src/main/java/org/logstash/bivalues/TimestampBiValue.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/bivalues/TimestampBiValue.java
rename to src/main/java/org/logstash/bivalues/TimestampBiValue.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/BufferedChecksum.java b/src/main/java/org/logstash/common/io/BufferedChecksum.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/BufferedChecksum.java
rename to src/main/java/org/logstash/common/io/BufferedChecksum.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/BufferedChecksumStreamInput.java b/src/main/java/org/logstash/common/io/BufferedChecksumStreamInput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/BufferedChecksumStreamInput.java
rename to src/main/java/org/logstash/common/io/BufferedChecksumStreamInput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/BufferedChecksumStreamOutput.java b/src/main/java/org/logstash/common/io/BufferedChecksumStreamOutput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/BufferedChecksumStreamOutput.java
rename to src/main/java/org/logstash/common/io/BufferedChecksumStreamOutput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/ByteArrayStreamOutput.java b/src/main/java/org/logstash/common/io/ByteArrayStreamOutput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/ByteArrayStreamOutput.java
rename to src/main/java/org/logstash/common/io/ByteArrayStreamOutput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/ByteBufferPageIO.java b/src/main/java/org/logstash/common/io/ByteBufferPageIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/ByteBufferPageIO.java
rename to src/main/java/org/logstash/common/io/ByteBufferPageIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/ByteBufferStreamInput.java b/src/main/java/org/logstash/common/io/ByteBufferStreamInput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/ByteBufferStreamInput.java
rename to src/main/java/org/logstash/common/io/ByteBufferStreamInput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/CheckpointIO.java b/src/main/java/org/logstash/common/io/CheckpointIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/CheckpointIO.java
rename to src/main/java/org/logstash/common/io/CheckpointIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/CheckpointIOFactory.java b/src/main/java/org/logstash/common/io/CheckpointIOFactory.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/CheckpointIOFactory.java
rename to src/main/java/org/logstash/common/io/CheckpointIOFactory.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/FileCheckpointIO.java b/src/main/java/org/logstash/common/io/FileCheckpointIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/FileCheckpointIO.java
rename to src/main/java/org/logstash/common/io/FileCheckpointIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/InputStreamStreamInput.java b/src/main/java/org/logstash/common/io/InputStreamStreamInput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/InputStreamStreamInput.java
rename to src/main/java/org/logstash/common/io/InputStreamStreamInput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/MemoryCheckpointIO.java b/src/main/java/org/logstash/common/io/MemoryCheckpointIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/MemoryCheckpointIO.java
rename to src/main/java/org/logstash/common/io/MemoryCheckpointIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/MmapPageIO.java b/src/main/java/org/logstash/common/io/MmapPageIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/MmapPageIO.java
rename to src/main/java/org/logstash/common/io/MmapPageIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/PageIO.java b/src/main/java/org/logstash/common/io/PageIO.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/PageIO.java
rename to src/main/java/org/logstash/common/io/PageIO.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/PageIOFactory.java b/src/main/java/org/logstash/common/io/PageIOFactory.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/PageIOFactory.java
rename to src/main/java/org/logstash/common/io/PageIOFactory.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/StreamInput.java b/src/main/java/org/logstash/common/io/StreamInput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/StreamInput.java
rename to src/main/java/org/logstash/common/io/StreamInput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/StreamOutput.java b/src/main/java/org/logstash/common/io/StreamOutput.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/StreamOutput.java
rename to src/main/java/org/logstash/common/io/StreamOutput.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/Streams.java b/src/main/java/org/logstash/common/io/Streams.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/Streams.java
rename to src/main/java/org/logstash/common/io/Streams.java
diff --git a/logstash-core/src/main/java/org/logstash/common/io/wip/MemoryPageIOStream.java b/src/main/java/org/logstash/common/io/wip/MemoryPageIOStream.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/common/io/wip/MemoryPageIOStream.java
rename to src/main/java/org/logstash/common/io/wip/MemoryPageIOStream.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/ext/JrubyEventExtLibrary.java b/src/main/java/org/logstash/ext/JrubyEventExtLibrary.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/ext/JrubyEventExtLibrary.java
rename to src/main/java/org/logstash/ext/JrubyEventExtLibrary.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/ext/JrubyTimestampExtLibrary.java b/src/main/java/org/logstash/ext/JrubyTimestampExtLibrary.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/ext/JrubyTimestampExtLibrary.java
rename to src/main/java/org/logstash/ext/JrubyTimestampExtLibrary.java
diff --git a/logstash-core-event-java/src/main/java/org/logstash/json/TimestampSerializer.java b/src/main/java/org/logstash/json/TimestampSerializer.java
similarity index 100%
rename from logstash-core-event-java/src/main/java/org/logstash/json/TimestampSerializer.java
rename to src/main/java/org/logstash/json/TimestampSerializer.java
diff --git a/logstash-core/src/main/java/org/logstash/log/CustomLogEvent.java b/src/main/java/org/logstash/log/CustomLogEvent.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/log/CustomLogEvent.java
rename to src/main/java/org/logstash/log/CustomLogEvent.java
diff --git a/logstash-core/src/main/java/org/logstash/log/CustomLogEventSerializer.java b/src/main/java/org/logstash/log/CustomLogEventSerializer.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/log/CustomLogEventSerializer.java
rename to src/main/java/org/logstash/log/CustomLogEventSerializer.java
diff --git a/logstash-core/src/main/java/org/logstash/log/LogstashLogEventFactory.java b/src/main/java/org/logstash/log/LogstashLogEventFactory.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/log/LogstashLogEventFactory.java
rename to src/main/java/org/logstash/log/LogstashLogEventFactory.java
diff --git a/logstash-core/src/main/java/org/logstash/log/LogstashMessageFactory.java b/src/main/java/org/logstash/log/LogstashMessageFactory.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/log/LogstashMessageFactory.java
rename to src/main/java/org/logstash/log/LogstashMessageFactory.java
diff --git a/logstash-core/src/main/java/org/logstash/log/StructuredMessage.java b/src/main/java/org/logstash/log/StructuredMessage.java
similarity index 100%
rename from logstash-core/src/main/java/org/logstash/log/StructuredMessage.java
rename to src/main/java/org/logstash/log/StructuredMessage.java
diff --git a/logstash-core/src/main/resources/log4j2.component.properties b/src/main/resources/log4j2.component.properties
similarity index 100%
rename from logstash-core/src/main/resources/log4j2.component.properties
rename to src/main/resources/log4j2.component.properties
diff --git a/logstash-core-event-java/src/test/java/org/logstash/AccessorsTest.java b/src/test/java/org/logstash/AccessorsTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/AccessorsTest.java
rename to src/test/java/org/logstash/AccessorsTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/EventTest.java b/src/test/java/org/logstash/EventTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/EventTest.java
rename to src/test/java/org/logstash/EventTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/FieldReferenceTest.java b/src/test/java/org/logstash/FieldReferenceTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/FieldReferenceTest.java
rename to src/test/java/org/logstash/FieldReferenceTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/JavafierTest.java b/src/test/java/org/logstash/JavafierTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/JavafierTest.java
rename to src/test/java/org/logstash/JavafierTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/KeyNodeTest.java b/src/test/java/org/logstash/KeyNodeTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/KeyNodeTest.java
rename to src/test/java/org/logstash/KeyNodeTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/RubyfierTest.java b/src/test/java/org/logstash/RubyfierTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/RubyfierTest.java
rename to src/test/java/org/logstash/RubyfierTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/StringInterpolationTest.java b/src/test/java/org/logstash/StringInterpolationTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/StringInterpolationTest.java
rename to src/test/java/org/logstash/StringInterpolationTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/TestBase.java b/src/test/java/org/logstash/TestBase.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/TestBase.java
rename to src/test/java/org/logstash/TestBase.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/TimestampTest.java b/src/test/java/org/logstash/TimestampTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/TimestampTest.java
rename to src/test/java/org/logstash/TimestampTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/ValuefierTest.java b/src/test/java/org/logstash/ValuefierTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/ValuefierTest.java
rename to src/test/java/org/logstash/ValuefierTest.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/CheckpointTest.java b/src/test/java/org/logstash/ackedqueue/CheckpointTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/CheckpointTest.java
rename to src/test/java/org/logstash/ackedqueue/CheckpointTest.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/HeadPageTest.java b/src/test/java/org/logstash/ackedqueue/HeadPageTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/HeadPageTest.java
rename to src/test/java/org/logstash/ackedqueue/HeadPageTest.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/QueueTest.java b/src/test/java/org/logstash/ackedqueue/QueueTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/QueueTest.java
rename to src/test/java/org/logstash/ackedqueue/QueueTest.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/StringElement.java b/src/test/java/org/logstash/ackedqueue/StringElement.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/StringElement.java
rename to src/test/java/org/logstash/ackedqueue/StringElement.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/TestQueue.java b/src/test/java/org/logstash/ackedqueue/TestQueue.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/TestQueue.java
rename to src/test/java/org/logstash/ackedqueue/TestQueue.java
diff --git a/logstash-core/src/test/java/org/logstash/ackedqueue/TestSettings.java b/src/test/java/org/logstash/ackedqueue/TestSettings.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/ackedqueue/TestSettings.java
rename to src/test/java/org/logstash/ackedqueue/TestSettings.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/bivalues/BiValueTest.java b/src/test/java/org/logstash/bivalues/BiValueTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/bivalues/BiValueTest.java
rename to src/test/java/org/logstash/bivalues/BiValueTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/bivalues/BiValuesTest.java b/src/test/java/org/logstash/bivalues/BiValuesTest.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/bivalues/BiValuesTest.java
rename to src/test/java/org/logstash/bivalues/BiValuesTest.java
diff --git a/logstash-core-event-java/src/test/java/org/logstash/bivalues/SomeJavaObject.java b/src/test/java/org/logstash/bivalues/SomeJavaObject.java
similarity index 100%
rename from logstash-core-event-java/src/test/java/org/logstash/bivalues/SomeJavaObject.java
rename to src/test/java/org/logstash/bivalues/SomeJavaObject.java
diff --git a/logstash-core/src/test/java/org/logstash/common/io/ByteBufferPageIOTest.java b/src/test/java/org/logstash/common/io/ByteBufferPageIOTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/common/io/ByteBufferPageIOTest.java
rename to src/test/java/org/logstash/common/io/ByteBufferPageIOTest.java
diff --git a/logstash-core/src/test/java/org/logstash/common/io/FileCheckpointIOTest.java b/src/test/java/org/logstash/common/io/FileCheckpointIOTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/common/io/FileCheckpointIOTest.java
rename to src/test/java/org/logstash/common/io/FileCheckpointIOTest.java
diff --git a/logstash-core/src/test/java/org/logstash/common/io/FileMmapIOTest.java b/src/test/java/org/logstash/common/io/FileMmapIOTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/common/io/FileMmapIOTest.java
rename to src/test/java/org/logstash/common/io/FileMmapIOTest.java
diff --git a/logstash-core/src/test/java/org/logstash/common/io/MemoryCheckpointTest.java b/src/test/java/org/logstash/common/io/MemoryCheckpointTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/common/io/MemoryCheckpointTest.java
rename to src/test/java/org/logstash/common/io/MemoryCheckpointTest.java
diff --git a/logstash-core/src/test/java/org/logstash/common/io/wip/MemoryPageIOStreamTest.java b/src/test/java/org/logstash/common/io/wip/MemoryPageIOStreamTest.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/common/io/wip/MemoryPageIOStreamTest.java
rename to src/test/java/org/logstash/common/io/wip/MemoryPageIOStreamTest.java
diff --git a/logstash-core/src/test/java/org/logstash/log/CustomLogEventTests.java b/src/test/java/org/logstash/log/CustomLogEventTests.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/log/CustomLogEventTests.java
rename to src/test/java/org/logstash/log/CustomLogEventTests.java
diff --git a/logstash-core/src/test/java/org/logstash/stress/Concurent.java b/src/test/java/org/logstash/stress/Concurent.java
similarity index 100%
rename from logstash-core/src/test/java/org/logstash/stress/Concurent.java
rename to src/test/java/org/logstash/stress/Concurent.java
diff --git a/logstash-core/src/test/resources/log4j-list.properties b/src/test/resources/log4j-list.properties
similarity index 100%
rename from logstash-core/src/test/resources/log4j-list.properties
rename to src/test/resources/log4j-list.properties
diff --git a/logstash-core/src/test/resources/log4j2-test1.xml b/src/test/resources/log4j2-test1.xml
similarity index 100%
rename from logstash-core/src/test/resources/log4j2-test1.xml
rename to src/test/resources/log4j2-test1.xml
diff --git a/logstash-core/src/test/resources/org/logstash/common/io/checkpoint.head b/src/test/resources/org/logstash/common/io/checkpoint.head
similarity index 100%
rename from logstash-core/src/test/resources/org/logstash/common/io/checkpoint.head
rename to src/test/resources/org/logstash/common/io/checkpoint.head
